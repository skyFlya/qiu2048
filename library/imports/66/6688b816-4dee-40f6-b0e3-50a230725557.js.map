{"version":3,"sources":["assets\\scripts\\mgrs\\DialogMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { App } from \"../app/App\";\r\nimport DialogBase, { DialogClickType } from \"../ui/DialogBase\";\r\nimport UIBase from \"../ui/UIBase\";\r\n\r\n\r\nexport class DialogMgr {\r\n\r\n    private static _instance: DialogMgr = null;\r\n    private static _dialogId: number = 0;\r\n\r\n    private _waittingDisplayList: Array<any> = [];\r\n    private _curDisplay: any = null;\r\n\r\n    public static getInstance(): DialogMgr {\r\n        if (DialogMgr._instance == null) {\r\n            DialogMgr._instance = new DialogMgr();\r\n        }\r\n        return DialogMgr._instance;\r\n    }\r\n\r\n    public static destroyInstance():void {\r\n        if (DialogMgr._instance) {\r\n            DialogMgr._instance = null;\r\n        }\r\n    }\r\n\r\n    public showDialog(name: string, content: string, callback?: (dialogBase: DialogBase) => void, clickCallback?: (code: DialogClickType) => void): number {\r\n        const dialogId = ++DialogMgr._dialogId;\r\n        if (this._curDisplay) {\r\n            this._waittingDisplayList.push({\r\n                dialogId: dialogId,\r\n                name: name,\r\n                content: content,\r\n                callback: callback,\r\n                clickCallback: clickCallback\r\n            });\r\n        } else {\r\n            this._curDisplay = {\r\n                dialogId: dialogId,\r\n                name: name,\r\n                content: content,\r\n                callback: callback,\r\n                clickCallback: clickCallback\r\n            }\r\n            App.uiMgr.openUI(name, (uiBase: UIBase)=>{\r\n                const dialog = uiBase as DialogBase;\r\n                dialog.content = content;\r\n                dialog.dialogId = dialogId;\r\n                dialog.setClickCallback(clickCallback); \r\n                callback && callback(dialog);\r\n            });\r\n        }\r\n        return dialogId;\r\n    }\r\n\r\n    public closeDialog(dialog: DialogBase): void {\r\n        dialog && this.closeDialogById(dialog.dialogId);\r\n    }\r\n\r\n    public closeDialogById(dialogId: number): void {\r\n        if (this._curDisplay && this._curDisplay.dialogId == dialogId) {\r\n            App.uiMgr.closeUI(this._curDisplay.name, true, ()=>{\r\n                this._curDisplay = null;\r\n                this.tryShowNext();\r\n            });\r\n        } else {\r\n            for (let i = 0; i < this._waittingDisplayList.length; i++) {\r\n                if (this._waittingDisplayList[i].dialogId == dialogId) {\r\n                    this._waittingDisplayList.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public clearDialogs(): void {\r\n        if (this._curDisplay) {\r\n            App.uiMgr.closeUI(this._curDisplay.name);\r\n            this._curDisplay = null;\r\n        }\r\n        this._waittingDisplayList = [];\r\n    }\r\n\r\n    private tryShowNext(): void {\r\n        if (this._curDisplay == null && this._waittingDisplayList.length > 0) {\r\n            const cfg = this._waittingDisplayList.shift();\r\n            this._curDisplay = cfg;\r\n            App.uiMgr.openUI(cfg.name, (uiBase: UIBase)=>{\r\n                const dialog = uiBase as DialogBase;\r\n                dialog.content = cfg.content;\r\n                dialog.dialogId = cfg.dialogId;\r\n                dialog.setClickCallback(cfg.clickCallback); \r\n                cfg.callback && cfg.callback(dialog);\r\n            });\r\n        }\r\n    }\r\n}"]}